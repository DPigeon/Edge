<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="../resources/bootstrap.min.css">
	<link rel="stylesheet" href="../resources/SignUp.css">

	<title>Register</title>
</head>

<body>

<form id="FormRegister" novalidate>
		<div class="form-group">
			<div class="input-group">
				<label for="InputFirstName">First Name</label>
				<div><input type="text" class="form-control" id="InputFirstName" name="firstname" placeholder="firstname" aria-describedby="HelpBlockFirstName"></div>
				<small id="HelpBlockFirstName" class="form-text text-muted">Please enter your first name.</small>
			</div>
			<div class="input-error" id="ErrorMessageFirstName"></div>
		</div>

		<div class="form-group">
			<div class="input-group">
				<label for="InputLastName">Last Name</label>
				<div><input type="text" class="form-control" id="InputLastName" name="lastname" placeholder="lastname" aria-describedby="HelpBlockLastName"></div>
				<small id="HelpBlockLastName" class="form-text text-muted">Please enter your last name.</small>
			</div>
			<div class="input-error" id="ErrorMessageLastName"></div>
		</div>

		<div class="form-group">
			<div class="input-group">
				<label for="InputEmail">Email Address</label>
				<div><input type="email" class="form-control" id="InputEmail" name="email" placeholder="email@example.com" aria-describedby="HelpBlockEmail"></div>
				<small id="HelpBlockEmail" class="form-text text-muted">Please enter a valid email</small>
			</div>
			<div class="input-error" id="ErrorMessageEmail"></div>
		</div>

		<div class="form-group">
			<div class="input-group">
				<label for="InputPassword">Password</label>
				<div><input type="password" class="form-control" id="InputPassword" name="password" placeholder="password" aria-describedby="HelpBlockPassword"></div>
				<small id="HelpBlockPassword" class="form-text text-muted">Please enter your password. It must be 8 to 20 characters long</small>
			</div>
			<div class="input-error" id="ErrorMessagePassword"></div>
		</div>


		<div class="form-group form-check">
			<input class="form-check-input" type="checkbox" value="" id="CheckBoxTeacher">
			<label class="form-check-label" for="CheckBoxTeacher">
				Are you a teacher ?
			</label>
		</div>

		<div class="form-group">
			<button id="ButtonSubmit" class="btn btn-primary" type="submit">Submit</button>
		</div>
</form>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="../resources/jquery-3.3.1.js"></script>
<script src="../resources/jquery.validate.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="../resources/bootstrap.min.js"></script>

<script>
	$.validator.setDefaults({
		highlight: (element) => {
			$(element).removeClass("is-valid");
			$(element).addClass("is-invalid");
		},
		unhighlight: (element) => {
			$(element).removeClass("is-invalid");
			$(element).addClass("is-valid");
		},
		errorElement: 'div',
		errorClass: 'invalid-feedback',
	});

	$("#FormRegister").validate({
		rules: {
			firstname: {
				required: true,
				minlength: 2
			},
			lastname: {
				required: true,
				minlength: 2
			},
			password: {
				required: true,
				minlength: 8
			},
			email: {
				required: true,
				email: true
			}
		},
		messages: {
			firstname: {
				required: "Your first name is required",
				minlength: jQuery.validator.format("Your first name should be at least {0} characters long")
			},
			lastname: {
				required: "Your last name is required",
				minlength: jQuery.validator.format("Your first name should be at least {0} characters long")
			},
			password: {
				required: "A password is required",
				minlength: jQuery.validator.format("Your password should be at least {0} characters long")
			},
			email: {
				required: "An email is required",
				email: "Your email should be a valid one"
			}
		},
		errorPlacement: (error, element) => {
			console.log(element.attr('id'));
			switch(element.attr('id')) {
				case "InputFirstName":
					error.appendTo($("#ErrorMessageFirstName"));
					break;
				case "InputLastName":
					error.appendTo($("#ErrorMessageLastName"));
					break;
				case "InputEmail":
					error.appendTo($("#ErrorMessageEmail"));
					break;
				case "InputPassword":
					error.appendTo($("#ErrorMessagePassword"));
					break;
			}
		},
		submitHandler: (form) => {
			let data = {
				firstname: $("#InputFirstName").val(),
				lastname: $("#InputLastName").val(),
				email: $("#InputEmail").val(),
				password: $("#InputPassword").val(),
				teacher: $("#CheckBoxTeacher").is(":checked")
			};

			console.log(JSON.stringify(data));

			return false;
			request = $.ajax({
				type: "POST",
				cache: false,
				url: "https://5e0ec07f-8ef7-44f7-8c6a-678421ac3f08.mock.pstmn.io/user",
				data: JSON.stringify(data),
				timeout: 3000
			});

			request.done((data, textStatus, jqXHR) => {
				console.log("Request good");
				console.log("Answer : " + data, textStatus);
				console.log(jqXHR);
			});

			request.fail((jqXHR, textStatus, errorThrown) => {
				console.log("Request fail");
				console.log("Answer : " + textStatus, errorThrown);
				console.log(jqXHR);
			});
		}
	});

</script>

</body>

</html>